# Nginx Gateway –¥–ª—è VSS OMNI TELECOM

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ reverse proxy (—à–ª—é–∑) –¥–ª—è –≤—Å–µ—Ö VSS —Å–µ—Ä–≤–∏—Å–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 80
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
- –£–¥–æ–±–Ω—ã–µ URL –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤

## üöÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Nginx

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```batch
# –ó–∞–ø—É—Å–∫ Nginx
nginx-control.bat start

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
nginx-control.bat stop

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
nginx-control.bat restart

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx-control.bat test

# –°—Ç–∞—Ç—É—Å Nginx
nginx-control.bat status
```

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```batch
# –ó–∞–ø—É—Å–∫
cd C:\nginx
start nginx.exe

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
taskkill /F /IM nginx.exe

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx.exe -s reload

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx.exe -t
```

## üåê URL –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

### –ß–µ—Ä–µ–∑ Nginx (–ø–æ—Ä—Ç 80):

| –°–µ—Ä–≤–∏—Å | –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø | –ß–µ—Ä–µ–∑ Nginx |
|--------|---------------|-------------|
| **Install Wizard** | `http://79.137.207.215:3000/` | `http://79.137.207.215/` |
| **VSS Demiurge** | `http://79.137.207.215:8181/` | `http://79.137.207.215/demiurge/` |
| **Admin Backend** | `http://79.137.207.215:8095/` | `http://79.137.207.215/admin/` |
| **Workspace** | `http://79.137.207.215:3001/` | `http://79.137.207.215/workspace/` |
| **Point API** | `http://79.137.207.215:8086/api/` | `http://79.137.207.215/api/point/` |
| **DCI API** | `http://79.137.207.215:8084/api/` | `http://79.137.207.215/api/dci/` |
| **OTTB API** | `http://79.137.207.215:8085/api/` | `http://79.137.207.215/api/ottb/` |

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ endpoint'—ã:

- **Health Check**: `http://79.137.207.215/health`
- **Nginx Status**: `http://79.137.207.215/nginx-status` (—Ç–æ–ª—å–∫–æ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ IP)

## üìÅ –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª:
```
C:\nginx\conf\nginx.conf
```

### –õ–æ–≥–∏:
```
C:\nginx\logs\access.log  - –õ–æ–≥ –¥–æ—Å—Ç—É–ø–∞
C:\nginx\logs\error.log   - –õ–æ–≥ –æ—à–∏–±–æ–∫
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```nginx
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
client_max_body_size 100M;

# –¢–∞–π–º–∞—É—Ç—ã
proxy_connect_timeout 600s;
proxy_send_timeout 600s;
proxy_read_timeout 600s;

# –ë—É—Ñ–µ—Ä—ã
client_body_buffer_size 1M;
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `C:\nginx\conf\nginx.conf`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π `location` –±–ª–æ–∫:

```nginx
location /my-service/ {
    rewrite ^/my-service/(.*) /$1 break;
    proxy_pass http://127.0.0.1:PORT;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:
```batch
nginx-control.bat restart
```

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Nginx –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ –ø–æ—Ä—Ç 80:
```powershell
Test-NetConnection -ComputerName localhost -Port 80
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```batch
cd C:\nginx
nginx.exe -t
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫:
```batch
type C:\nginx\logs\error.log
```

### Nginx –Ω–µ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω:
```powershell
Test-NetConnection -ComputerName localhost -Port 3000
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ access.log:
```batch
type C:\nginx\logs\access.log
```

3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É (–±–µ–∑ Nginx)

### –û—à–∏–±–∫–∞ "Address already in use"

–ü–æ—Ä—Ç 80 –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º:

```powershell
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 80
Get-NetTCPConnection -LocalPort 80 | Select-Object OwningProcess
Get-Process -Id [PID]

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
Stop-Process -Id [PID] -Force
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:

```batch
nginx-control.bat status
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```powershell
Get-Content C:\nginx\logs\access.log -Wait -Tail 20
```

### Health check:

```powershell
Invoke-WebRequest -Uri http://127.0.0.1/health
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (100MB)
- ‚úÖ –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è
- ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ IP –∫–ª–∏–µ–Ω—Ç–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSocket

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–î–æ–±–∞–≤–∏—Ç—å SSL/HTTPS** (–¥–ª—è production):
```nginx
server {
    listen 443 ssl http2;
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}
```

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞**:
```nginx
location /admin/ {
    allow 79.137.207.215;
    deny all;
    # ... proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

3. **Rate limiting**:
```nginx
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;

location /api/ {
    limit_req zone=api_limit burst=20 nodelay;
    # ... proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

## üìù –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Windows

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª—É–∂–±—ã Windows:

1. –°–∫–∞—á–∞–π—Ç–µ NSSM (Non-Sucking Service Manager)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx –∫–∞–∫ —Å–ª—É–∂–±—É:

```batch
nssm install nginx "C:\nginx\nginx.exe"
nssm set nginx AppDirectory "C:\nginx"
nssm start nginx
```

### –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É "Nginx VSS"
3. –¢—Ä–∏–≥–≥–µ—Ä: –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã
4. –î–µ–π—Å—Ç–≤–∏–µ: `C:\nginx\nginx.exe`
5. –†–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞: `C:\nginx`

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Nginx:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ VSS —Å–µ—Ä–≤–∏—Å—ã:
```batch
npm run start:all
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:
```batch
nginx-control.bat start
```

3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:
```
http://79.137.207.215/
```

4. –ì–æ—Ç–æ–≤–æ! üéâ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Nginx
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ firewall –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç 80
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ VSS —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: 2025-12-04  
**Nginx –≤–µ—Ä—Å–∏—è**: 1.24.0

